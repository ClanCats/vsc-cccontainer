(()=>{"use strict";var e={989:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CtnCompletionProvider=void 0;const r=n(496),a=n(147),o=n(37),s=n(17),i=n(81),c=[],p=[];let l=0;function u(){const e=new Set(c);c.length=0,c.push(...e)}function h(e,t){const n=t.match(/protected array \$serviceResolverType = \[.*\]/g);if(n&&n.length>0){const e=n[0].matchAll(/'([a-zA-Z\._]+)'/g);for(const t of e)c.push(t[1])}u()}t.CtnCompletionProvider=class{provideCompletionItems(e,t,n,m){!function(){const e=r.workspace.workspaceFolders?.[0].uri.fsPath+"/var/cache/AppContainer.php",t=a.statSync(e);if(t.mtimeMs>l){l=t.mtimeMs;const n=a.readFileSync(e,"utf8");let m=r.workspace.getConfiguration("ctn").get("phpBinary");if(!m){if(m=(0,i.execSync)("which php").toString().trim(),""===m||"php not found"===m)return void h(0,n);r.workspace.getConfiguration("ctn").update("phpBinary",m,!0)}!function(e,t,n){const r=t.matchAll(/class ([A-Za-z]+) extends ClanCatsContainer/g).next().value[1];if(!r||0===r.length)return void h(0,t);t=t.replace(/extends ClanCatsContainer[0-9a-z]+/g,"");const l=o.tmpdir(),m=s.join(l,"ctn_"+Math.random().toString(36).substring(2)+".php");a.existsSync(m)&&a.unlinkSync(m);let g=`\n    // make all properties accessible\n    $containerRefl = new ReflectionClass(${r}::class);\n    foreach ($containerRefl->getProperties() as $property) {\n        $property->setAccessible(true);\n    }\n\n    $container = new ${r}();\n    \n    // get the paramters\n    $data = [];\n    $data['parameters'] = $containerRefl->getProperty('parameters')->getValue($container);\n\n    // get the services\n    $data['services'] = $containerRefl->getProperty('serviceResolverType')->getValue($container);\n\n    echo json_encode($data);\n    `;a.writeFileSync(m,t+g);const d=(0,i.execSync)(n+" "+m).toString();try{const e=JSON.parse(d);p.push(...Object.keys(e.parameters)),c.push(...Object.keys(e.services)),u()}catch(e){console.error("error: "+e)}}(0,n,m.trim())}}();const g=e.lineAt(t).text.substr(0,t.character),d=/@([a-zA-Z0-9\._]+)?$/,f=/:([a-zA-Z0-9\._]+)?$/;if(d.test(g)){const e=g.match(d)?.[0].substring(1)??"",n=n=>{let a=new r.CompletionItem(n,r.CompletionItemKind.Class);return a.range=new r.Range(t.line,t.character-e.length,t.line,t.character),a};return 0===e.length?c.map((e=>n(e))):c.filter((t=>t.startsWith(e))).map((e=>n(e)))}if(f.test(g)){const e=g.match(f)?.[0].substring(1)??"",n=n=>{let a=new r.CompletionItem(n,r.CompletionItemKind.Class);return a.range=new r.Range(t.line,t.character-e.length,t.line,t.character),a};return 0===e.length?p.map((e=>n(e))):p.filter((t=>t.startsWith(e))).map((e=>n(e)))}}}},496:e=>{e.exports=require("vscode")},81:e=>{e.exports=require("child_process")},147:e=>{e.exports=require("fs")},37:e=>{e.exports=require("os")},17:e=>{e.exports=require("path")}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=n(496),a=n(989);e.activate=function(e){e.subscriptions.push(t.languages.registerCompletionItemProvider({scheme:"file",language:"ctn"},new a.CtnCompletionProvider,"@",":"))},e.deactivate=function(){}})(),module.exports=r})();